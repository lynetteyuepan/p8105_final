<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>final project</title>

<script src="site_libs/jquery-1.12.4/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-1.1/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-1.1/highlight.js"></script>
<script src="site_libs/htmlwidgets-0.9/htmlwidgets.js"></script>
<script src="site_libs/datatables-binding-0.2/datatables.js"></script>
<link href="site_libs/dt-core-1.10.12/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.10.12/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.10.12/js/jquery.dataTables.min.js"></script>
<script src="site_libs/plotly-binding-4.7.1/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotlyjs-1.29.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotlyjs-1.29.2/plotly-latest.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Exploration of North American Box-office Indicating Factors (2006-2016)</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">Overview</a>
</li>
<li>
  <a href="about.html">Report</a>
</li>
<li>
  <a href="final_project_1.html">Exploration and Visualization</a>
</li>
<li>
  <a href="p8105_final.html">Total Gross</a>
</li>
<li>
  <a href="p8105_final_jh3909.html">Review scores</a>
</li>
<li>
  <a href="P8105_final_mc4433.html">Opening gross</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">final project</h1>

</div>


<pre class="r"><code>library(dplyr)</code></pre>
<pre><code>## Warning: package &#39;dplyr&#39; was built under R version 3.4.2</code></pre>
<pre><code>## 
## Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:stats&#39;:
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## Loading tidyverse: ggplot2
## Loading tidyverse: tibble
## Loading tidyverse: tidyr
## Loading tidyverse: readr
## Loading tidyverse: purrr</code></pre>
<pre><code>## Conflicts with tidy packages ----------------------------------------------</code></pre>
<pre><code>## filter(): dplyr, stats
## lag():    dplyr, stats</code></pre>
<pre class="r"><code>library(httr)
library(rvest)</code></pre>
<pre><code>## Loading required package: xml2</code></pre>
<pre><code>## 
## Attaching package: &#39;rvest&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     pluck</code></pre>
<pre><code>## The following object is masked from &#39;package:readr&#39;:
## 
##     guess_encoding</code></pre>
<pre class="r"><code>library(stringr)
library(forcats)
library(viridis)</code></pre>
<pre><code>## Loading required package: viridisLite</code></pre>
<pre class="r"><code>library(readr)
library(tidytext)</code></pre>
<pre><code>## Warning: package &#39;tidytext&#39; was built under R version 3.4.2</code></pre>
<pre class="r"><code>library(rvest)
library(janitor)
library(haven)
library(DT)
library(plotly)</code></pre>
<pre><code>## 
## Attaching package: &#39;plotly&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:httr&#39;:
## 
##     config</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     last_plot</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre><code>## The following object is masked from &#39;package:graphics&#39;:
## 
##     layout</code></pre>
<div id="prepare-datasets" class="section level1">
<h1>Prepare datasets</h1>
<pre class="r"><code>##Top 10 movies with best box-office 
movie_with_boxoffice %&gt;% 
  group_by(movie_title) %&gt;% 
  summarize(box_movie = sum(total_gross_millions, na.rm = TRUE)) %&gt;% 
  arrange(desc(box_movie)) %&gt;% 
  head(10) %&gt;% 
  datatable()</code></pre>
<div id="htmlwidget-435f92e833e5f1a9a10f" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-435f92e833e5f1a9a10f">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10"],["Star Wars: Episode VII - The Force Awakens","Avatar","Jurassic World","The Avengers","The Dark Knight","Rogue One","Finding Dory","Avengers: Age of Ultron","The Dark Knight Rises","The Hunger Games: Catching Fire"],[936.63,749.766139,652.270625,623.28,533.345358,532.17,486.295561,459.005868,448.139099,424.668047]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>movie_title<\/th>\n      <th>box_movie<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>##Director:  The top 10 ranked director with best box-office
movie_with_boxoffice %&gt;% 
  group_by(director) %&gt;% 
  summarize(box_movie = sum(total_gross_millions, na.rm = TRUE)) %&gt;% 
  arrange(desc(box_movie)) %&gt;% 
  head(10) %&gt;% 
  datatable()</code></pre>
<div id="htmlwidget-342daf62c57fb7fd61c7" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-342daf62c57fb7fd61c7">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10"],["J.J. Abrams","David Yates","Christopher Nolan","Michael Bay","Francis Lawrence","Joss Whedon","Jon Favreau","Zack Snyder","Peter Jackson","Gore Verbinski"],[1684.17266,1630.566996,1515.17056,1421.877682,1299.920844,1082.285868,1026.269435,975.898013,860.604443,830.138352]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>director<\/th>\n      <th>box_movie<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>##Type: The top 10 ranked type of movies with best box-office
movie_with_boxoffice %&gt;% 
  mutate(genre = as.character(genre)) %&gt;% 
  unnest_tokens(word,genre) %&gt;% 
  mutate(genre = word) %&gt;% 
  group_by(genre)%&gt;%
  summarize(box_movie = sum(total_gross_millions, na.rm = TRUE)) %&gt;% 
  filter(!genre==&quot;fi&quot;) %&gt;% 
  mutate(genre = stringr::str_replace(genre, &quot;sci&quot;, &quot;sci-fi&quot;)) %&gt;%
  arrange(desc(box_movie)) %&gt;% 
  head(10) %&gt;% 
  datatable()</code></pre>
<div id="htmlwidget-ef36a62044620361de57" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ef36a62044620361de57">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10"],["adventure","action","drama","comedy","sci-fi","fantasy","thriller","animation","crime","family"],[39064.186611,35999.31234,22190.777007,19597.635428,15071.65839,12255.425495,10716.900223,8988.470215,8058.383462,6315.81868]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>genre<\/th>\n      <th>box_movie<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>##Donut charts represent genre 
movie_with_boxoffice %&gt;% 
  mutate(genre = as.character(genre)) %&gt;% 
  unnest_tokens(word, genre) %&gt;% 
  mutate(genre = word) %&gt;% 
  group_by(genre) %&gt;%
  summarize(box_movie = sum(total_gross_millions, na.rm = TRUE)) %&gt;% 
  filter(!genre==&quot;fi&quot;) %&gt;% 
  mutate(genre = stringr::str_replace(genre, &quot;sci&quot;, &quot;sci-fi&quot;)) %&gt;% 
  arrange(desc(box_movie)) %&gt;% 
  plot_ly(labels = ~genre, values = ~box_movie, textposition = &#39;inside&#39;,
        textinfo = &#39;label+percent&#39;) %&gt;%
  add_pie(hole = 0.6) %&gt;%
  layout(title = &quot;Donut charts using Plotly&quot;,  showlegend = FALSE,
         xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
         yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE)) </code></pre>
<div id="39813a13075d" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="39813a13075d">{"x":{"visdat":{"3981409dd51f":["function () ","plotlyVisDat"]},"cur_data":"3981409dd51f","attrs":{"3981409dd51f":{"labels":{},"values":{},"textposition":"inside","textinfo":"label+percent","alpha":1,"sizes":[10,100],"type":"pie","hole":0.6}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Donut charts using Plotly","showlegend":false,"xaxis":{"showgrid":false,"zeroline":false,"showticklabels":false},"yaxis":{"showgrid":false,"zeroline":false,"showticklabels":false},"hovermode":"closest"},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"labels":["adventure","action","drama","comedy","sci-fi","fantasy","thriller","animation","crime","family","romance","mystery","biography","horror","history","sport","music","western","war","musical"],"values":[39064.186611,35999.31234,22190.777007,19597.635428,15071.65839,12255.425495,10716.900223,8988.470215,8058.383462,6315.81868,5612.50525,4888.557129,4183.668193,3414.834644,1376.563337,1072.208062,773.039309,559.869854,534.399439,408.670422],"textposition":["inside","inside","inside","inside","inside","inside","inside","inside","inside","inside","inside","inside","inside","inside","inside","inside","inside","inside","inside","inside"],"textinfo":"label+percent","type":"pie","hole":0.6,"marker":{"fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)","line":{"color":"transparent"}},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<pre class="r"><code>movie_with_boxoffice %&gt;% 
  mutate(genre = as.character(genre)) %&gt;% 
  tidytext::unnest_tokens(word, genre) %&gt;% 
  mutate(genre = word) %&gt;% 
  group_by(genre) %&gt;%
  summarize(box_movie = sum(total_gross_millions, na.rm = TRUE)) %&gt;% 
  filter(!genre==&quot;fi&quot;) %&gt;% 
  mutate(genre = stringr::str_replace(genre, &quot;sci&quot;, &quot;sci-fi&quot;)) %&gt;% 
  arrange(desc(box_movie)) %&gt;% 
  plot_ly(., x = ~genre,  y = ~box_movie, color = ~genre, type = &quot;bar&quot;)</code></pre>
<pre><code>## Warning in RColorBrewer::brewer.pal(N, &quot;Set2&quot;): n too large, allowed maximum for palette Set2 is 8
## Returning the palette you asked for with that many colors</code></pre>
<div id="398153aae2ae" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="398153aae2ae">{"x":{"visdat":{"39814cdb5505":["function () ","plotlyVisDat"]},"cur_data":"39814cdb5505","attrs":{"39814cdb5505":{"x":{},"y":{},"color":{},"alpha":1,"sizes":[10,100],"type":"bar"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"title":"genre","type":"category","categoryorder":"array","categoryarray":["action","adventure","animation","biography","comedy","crime","drama","family","fantasy","history","horror","music","musical","mystery","romance","sci-fi","sport","thriller","war","western"]},"yaxis":{"domain":[0,1],"title":"box_movie"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":[{"name":"Collaborate","icon":{"width":1000,"ascent":500,"descent":-50,"path":"M487 375c7-10 9-23 5-36l-79-259c-3-12-11-23-22-31-11-8-22-12-35-12l-263 0c-15 0-29 5-43 15-13 10-23 23-28 37-5 13-5 25-1 37 0 0 0 3 1 7 1 5 1 8 1 11 0 2 0 4-1 6 0 3-1 5-1 6 1 2 2 4 3 6 1 2 2 4 4 6 2 3 4 5 5 7 5 7 9 16 13 26 4 10 7 19 9 26 0 2 0 5 0 9-1 4-1 6 0 8 0 2 2 5 4 8 3 3 5 5 5 7 4 6 8 15 12 26 4 11 7 19 7 26 1 1 0 4 0 9-1 4-1 7 0 8 1 2 3 5 6 8 4 4 6 6 6 7 4 5 8 13 13 24 4 11 7 20 7 28 1 1 0 4 0 7-1 3-1 6-1 7 0 2 1 4 3 6 1 1 3 4 5 6 2 3 3 5 5 6 1 2 3 5 4 9 2 3 3 7 5 10 1 3 2 6 4 10 2 4 4 7 6 9 2 3 4 5 7 7 3 2 7 3 11 3 3 0 8 0 13-1l0-1c7 2 12 2 14 2l218 0c14 0 25-5 32-16 8-10 10-23 6-37l-79-259c-7-22-13-37-20-43-7-7-19-10-37-10l-248 0c-5 0-9-2-11-5-2-3-2-7 0-12 4-13 18-20 41-20l264 0c5 0 10 2 16 5 5 3 8 6 10 11l85 282c2 5 2 10 2 17 7-3 13-7 17-13z m-304 0c-1-3-1-5 0-7 1-1 3-2 6-2l174 0c2 0 4 1 7 2 2 2 4 4 5 7l6 18c0 3 0 5-1 7-1 1-3 2-6 2l-173 0c-3 0-5-1-8-2-2-2-4-4-4-7z m-24-73c-1-3-1-5 0-7 2-2 3-2 6-2l174 0c2 0 5 0 7 2 3 2 4 4 5 7l6 18c1 2 0 5-1 6-1 2-3 3-5 3l-174 0c-3 0-5-1-7-3-3-1-4-4-5-6z"},"click":"function(gd) { \n        // is this being viewed in RStudio?\n        if (location.search == '?viewer_pane=1') {\n          alert('To learn about plotly for collaboration, visit:\\n https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html');\n        } else {\n          window.open('https://cpsievert.github.io/plotly_book/plot-ly-for-collaboration.html', '_blank');\n        }\n      }"}],"cloud":false},"data":[{"x":["action"],"y":[35999.31234],"type":"bar","name":"action","marker":{"fillcolor":"rgba(102,194,165,0.5)","color":"rgba(102,194,165,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":["adventure"],"y":[39064.186611],"type":"bar","name":"adventure","marker":{"fillcolor":"rgba(175,178,140,0.5)","color":"rgba(175,178,140,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":["animation"],"y":[8988.470215],"type":"bar","name":"animation","marker":{"fillcolor":"rgba(223,158,115,0.5)","color":"rgba(223,158,115,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":["biography"],"y":[4183.668193],"type":"bar","name":"biography","marker":{"fillcolor":"rgba(243,143,109,0.5)","color":"rgba(243,143,109,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":["comedy"],"y":[19597.635428],"type":"bar","name":"comedy","marker":{"fillcolor":"rgba(210,151,148,0.5)","color":"rgba(210,151,148,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":["crime"],"y":[8058.383462],"type":"bar","name":"crime","marker":{"fillcolor":"rgba(166,157,187,0.5)","color":"rgba(166,157,187,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":["drama"],"y":[22190.777007],"type":"bar","name":"drama","marker":{"fillcolor":"rgba(163,156,201,0.5)","color":"rgba(163,156,201,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":["family"],"y":[6315.81868],"type":"bar","name":"family","marker":{"fillcolor":"rgba(197,149,198,0.5)","color":"rgba(197,149,198,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":["fantasy"],"y":[12255.425495],"type":"bar","name":"fantasy","marker":{"fillcolor":"rgba(227,140,195,0.5)","color":"rgba(227,140,195,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":["history"],"y":[1376.563337],"type":"bar","name":"history","marker":{"fillcolor":"rgba(216,166,163,0.5)","color":"rgba(216,166,163,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":["horror"],"y":[3414.834644],"type":"bar","name":"horror","marker":{"fillcolor":"rgba(193,194,124,0.5)","color":"rgba(193,194,124,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":["music"],"y":[773.039309],"type":"bar","name":"music","marker":{"fillcolor":"rgba(171,216,82,0.5)","color":"rgba(171,216,82,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":["musical"],"y":[408.670422],"type":"bar","name":"musical","marker":{"fillcolor":"rgba(206,217,70,0.5)","color":"rgba(206,217,70,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":["mystery"],"y":[4888.557129],"type":"bar","name":"mystery","marker":{"fillcolor":"rgba(238,217,57,0.5)","color":"rgba(238,217,57,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":["romance"],"y":[5612.50525],"type":"bar","name":"romance","marker":{"fillcolor":"rgba(252,214,69,0.5)","color":"rgba(252,214,69,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":["sci-fi"],"y":[15071.65839],"type":"bar","name":"sci-fi","marker":{"fillcolor":"rgba(243,206,108,0.5)","color":"rgba(243,206,108,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":["sport"],"y":[1072.208062],"type":"bar","name":"sport","marker":{"fillcolor":"rgba(232,198,139,0.5)","color":"rgba(232,198,139,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":["thriller"],"y":[10716.900223],"type":"bar","name":"thriller","marker":{"fillcolor":"rgba(217,191,156,0.5)","color":"rgba(217,191,156,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":["war"],"y":[534.399439],"type":"bar","name":"war","marker":{"fillcolor":"rgba(199,185,168,0.5)","color":"rgba(199,185,168,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null},{"x":["western"],"y":[559.869854],"type":"bar","name":"western","marker":{"fillcolor":"rgba(179,179,179,0.5)","color":"rgba(179,179,179,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1}},"base_url":"https://plot.ly"},"evals":["config.modeBarButtonsToAdd.0.click"],"jsHooks":{"render":[{"code":"function(el, x) { var ctConfig = crosstalk.var('plotlyCrosstalkOpts').set({\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1}}); }","data":null}]}}</script>
<pre class="r"><code>##range </code></pre>
<pre class="r"><code>##Actor/Actress:  The top 10 ranked actor/actress with best box-office
movie_with_boxoffice %&gt;% 
  gather(key = actor, value = main_actor, actor1:actor4) %&gt;% 
  group_by(main_actor) %&gt;%
  summarize(box_movie = sum(total_gross_millions, na.rm = TRUE)) %&gt;% 
  arrange(desc(box_movie)) %&gt;% 
  head(10) %&gt;% 
  datatable()</code></pre>
<div id="htmlwidget-7b997e2fd3abcb1bb969" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-7b997e2fd3abcb1bb969">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10"],["Robert Downey Jr.","Jennifer Lawrence","Christian Bale"," Liam Hemsworth"," Zoe Saldana"," Josh Hutcherson"," Emma Watson","Will Smith"," Domhnall Gleeson","Johnny Depp"],[2565.117785,1758.117565,1559.763627,1538.586718,1532.04974,1496.338526,1388.893979,1341.373642,1299.668532,1281.321054]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>main_actor<\/th>\n      <th>box_movie<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row"}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>##Production company:  The top 10 ranked production company  with best box-office
movie_with_boxoffice %&gt;% 
  group_by(studio) %&gt;%
  na.omit() %&gt;% 
  summarize(box_movie = sum(total_gross_millions,na.rm = TRUE)) %&gt;% 
  arrange(desc(box_movie)) %&gt;% 
  head(10) %&gt;% 
  datatable()</code></pre>
<div id="htmlwidget-d2a5c88d87ca057abbb1" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-d2a5c88d87ca057abbb1">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10"],["BV","WB","Uni.","Fox","Par.","Sony","LGF","P/DW","WB (NL)","LG/S"],[9311.58165,6876.113691,6005.107051,5741.932676,5274.21497,3785.309733,2017.070609,1887.374462,1101.884793,714.222375]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>studio<\/th>\n      <th>box_movie<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false},"selection":{"mode":"multiple","selected":null,"target":"row"}},"evals":[],"jsHooks":[]}</script>
<p><strong>Word Cloud for Movie Descriptions from 2006 to 2016</strong> <img src="final_project_1_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
